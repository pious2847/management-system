<!-- Materials Modal - To be included in forms/materials/material.ejs -->
<div class="modal fade" id="materialsModal" tabindex="-1" aria-labelledby="materialsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="materialsModalLabel">Add/Update Material</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <form id="materialsForm" action="/materials/save" method="POST">
                <div class="modal-body">
                    <input type="hidden" name="_id" id="materialId">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="name" class="form-label">Material Name</label>
                            <input type="text" class="form-control" id="name" name="name" required 
                                minlength="2" maxlength="100" placeholder="Enter material name">
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="stock" class="form-label">Stock Quantity</label>
                            <input type="number" class="form-control" id="stock" name="stock" 
                                required min="0" placeholder="Enter stock quantity">
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="unit" class="form-label">Unit</label>
                            <select class="form-control" id="unit" name="unit" required>
                                <option value="">Select Unit</option>
                                <option value="kg">Kilogram (kg)</option>
                                <option value="g">Gram (g)</option>
                                <option value="l">Liter (l)</option>
                                <option value="ml">Milliliter (ml)</option>
                                <option value="piece">Piece</option>
                            </select>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="weight" class="form-label">Weight</label>
                            <div class="input-group">
                                <input type="number" step="0.01" class="form-control" id="weight" 
                                    name="weight" required min="0" placeholder="Enter weight">
                                <span class="input-group-text">kg/unit</span>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <label for="unitPrice" class="form-label">Unit Price</label>
                            <div class="input-group">
                                <span class="input-group-text">â‚µ</span>
                                <input type="number" step="0.01" class="form-control" id="unitPrice" 
                                    name="unitPrice" required min="0" placeholder="Enter unit price">
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <label for="description" class="form-label">Description</label>
                            <textarea class="form-control" id="description" name="description" 
                                rows="3" required minlength="10" maxlength="200" 
                                placeholder="Enter material description"></textarea>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
                    <button type="submit" class="btn btn-primary" id="saveButton">Save Material</button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
    function prepareModal(mode, material = null) {
        const modalTitle = document.getElementById('materialsModalLabel');
        const saveButton = document.getElementById('saveButton');
        const form = document.getElementById('materialsForm');

        // Reset form
        form.reset();
    }

    // Optional: Form validation before submission
    document.getElementById('materialsForm').addEventListener('submit', function(event) {
        if (!this.checkValidity()) {
            event.preventDefault();
            event.stopPropagation();
        }
        this.classList.add('was-validated');
    });
</script>